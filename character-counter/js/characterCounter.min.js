function sanitize(e){return e.field=e.field?e.field.trim():"",e.repeatable=e.repeatable?e.repeatable.trim():"",e.editable=e.editable?e.editable.trim():"",e.max=e.max?parseInt(e.max):"",e.min=e.min?parseInt(e.min):"",e.count=e.count?e.count.trim().toLowerCase():"",e.type=e.type?e.type.trim().toLowerCase():"",e.show=e.show?e.show.trim().toLowerCase():"",e.label=e.label?e.label:"",""===e.max&&(e.type="up"),e}function initCounter(e){if(sanitize(e),e.repeatable)return void repeatable(e);var t=e.field||"f_"+e.editable,n=document.getElementById(t),a=document.createElement("p"),i=t+"_counter";a.setAttribute("id",i),a.style.textAlign="right",n.parentNode.appendChild(a),startCounter(t,n,e)}function repeatable(e){var t=document.getElementById("addRow_f_"+e.repeatable);t&&t.addEventListener?t.addEventListener("click",function(){initCounter(e)}):t&&t.attachEvent&&t.attachEvent("onclick",function(){initCounter(e)});for(var n=0;field_name="f_",field_name+=e.repeatable+"-"+n+"-",field_name+=e.editable,target=document.getElementById(field_name),null!=target;n++)if(null==document.getElementById(field_name+"_counter")){var a=document.createElement("p"),i=field_name+"_counter";a.setAttribute("id",i),a.style.textAlign="right",target.parentNode.appendChild(a),startCounter(field_name,target,e)}}function startCounter(e,t,n){updateCounter(e,n.max,n.min,n.type,n.show,n.label),t.setAttribute("onkeydown","updateCounter('"+e+"', '"+n.max+"', '"+n.min+"', '"+n.type+"', '"+n.show+"', '"+n.label+"');"),t.setAttribute("onkeyup","updateCounter('"+e+"', '"+n.max+"', '"+n.min+"', '"+n.type+"', '"+n.show+"', '"+n.label+"');")}function updateCounter(e,t,n,a,i,r){var l=document.getElementById(e),o=document.getElementById(e+"_counter");if("up"==a)var d=l.value.length;else var d=t-l.value.length;o.innerHTML="<span>"+d+"</span>",o.children[0].style.color="up"==a?t&&d>t||n>d?"red":"green":n>d?"red":"green",n&&(i.indexOf("min")>=0||i.indexOf("both")>=0)&&(o.innerHTML="Min: "+n+"&nbsp;&nbsp;&nbsp;"+o.innerHTML),t&&(i.indexOf("max")>=0||i.indexOf("both")>=0)&&(o.innerHTML=o.innerHTML+"&nbsp;&nbsp;&nbsp;Max: "+t),o.innerHTML=r+"&nbsp;"+o.innerHTML}my_counters.forEach(initCounter);